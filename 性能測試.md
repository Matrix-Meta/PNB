matrix@ArchLinux ~/g/PNB (main)> ./master_benchmark

========================================
PNB Master Benchmark (Fixed)
========================================
Device: Intel(R) Arc(TM) B580 Graphics
========================================

=== Test 1: Types and Constants ===
  [PASS] PI constant
  [PASS] EPSILON constant
  [PASS] stable_coeff(0) = 0
  [PASS] stable_coeff(large) ≈ 1
  [PASS] Vector1D type
  [PASS] MatrixView type
  [PASS] Tensor3D type

=== Test 2: BitLinearXMX Layer (BF16) ===
  [PASS] BitLinearXMX forward
  Performance: 82.57 GFLOPS (50.80 µs/iter)
  [PASS] BitLinearXMX performance

=== Test 3: SSMScan Layer ===
  [PASS] SSMScan forward

=== Test 4: SpikeNeuron Layer ===
  [PASS] SpikeNeuron forward_single

=== Test 5: GlialCell ===
  [PASS] GlialCell regulate (high sparsity)
  [PASS] GlialCell regulate (low sparsity)
  [PASS] GlialCell stability check

=== Test 6: Hippocampus ===
  Familiarity score: 1.000
  Suggested threshold: 0.900
  [PASS] Hippocampus compute_familiarity
  [PASS] Hippocampus learn

========================================
Test Summary
========================================
Total tests: 16
Passed: 16 (100.0%)
Failed: 0
========================================

========================================
Performance Scaling Tests
========================================

=== BitLinearXMX Scaling (小~超大規模) ===
+---------------------+------------+-----------+------------+----------+
| Config              |   Elements |  Time(ms) |       GOPS |    GB/s  |
+---------------------+------------+-----------+------------+----------+
| 1x256x256           |      65536 |     0.022 |      59.04 |    29.98 |
| 1x512x512           |     262144 |     0.041 |     128.50 |    64.75 |
| 1x1024x1024         |    1048576 |     0.083 |     254.20 |   127.60 |
| 1x2048x2048         |    4194304 |     0.208 |     402.52 |   201.66 |
| 1x4096x4096         |   16777216 |     0.594 |     565.08 |   282.82 |
| 16x1024x1024        |   16777216 |     0.045 |    7540.32 |   250.36 |
| 64x1024x1024        |   67108864 |     0.068 |   19622.47 |   191.63 |
| 256x1024x1024       |  268435456 |     0.274 |   19600.98 |    76.57 |
+---------------------+------------+-----------+------------+----------+

=== SSMScan Scaling (小~超大規模) ===
+---------------------+------------+-----------+--------------+
| Config (BxLxD)      |   Elements |  Time(ms) |    M elem/s  |
+---------------------+------------+-----------+--------------+
| 1x1x1024            |       1024 |    0.0381 |      2685.55 |
| 1x1x4096            |       4096 |    0.0153 |     26859.02 |
| 1x1x16384           |      16384 |    0.0151 |    108575.22 |
| 1x1x65536           |      65536 |    0.0150 |    436615.59 |
| 16x1x4096           |      65536 |    0.0153 |    429181.40 |
| 64x1x4096           |     262144 |    0.0152 |   1720104.99 |
| 256x1x4096          |    1048576 |    0.0243 |   4320461.48 |
+---------------------+------------+-----------+--------------+

=== SpikeNeuron Scaling (小~超大規模) ===
+-----------------+------------+-----------+--------------+------------+
| Config (BxN)    |    Neurons |  Time(ms) |  M neurons/s |     Spikes |
+-----------------+------------+-----------+--------------+------------+
| 1x1024          |       1024 |    0.0185 |      5544.13 |      78831 |
| 1x4096          |       4096 |    0.0173 |     23648.96 |     315550 |
| 1x16384         |      16384 |    0.0174 |     94160.92 |    1262995 |
| 1x65536         |      65536 |    0.0172 |    381466.82 |    5051508 |
| 1x262144        |     262144 |    0.0174 |   1504845.01 |   20206943 |
| 16x16384        |     262144 |    0.0174 |   1503981.64 |   20206943 |
| 64x16384        |    1048576 |    0.0272 |   3849397.94 |   80828279 |
+-----------------+------------+-----------+--------------+------------+

========================================
Performance Tests Completed!
========================================
